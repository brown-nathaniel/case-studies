head(dat)
getwd()
knitr::opts_chunk$set(echo = TRUE)
library(mvtnorm)
library(ggplot2); library(dplyr); library(reshape2)
dat <- read.table("alllabs.txt", header = TRUE, stringsAsFactors = FALSE, na.strings = ".")
dat <- dat[!(is.na(dat$blot) | is.na(dat$body)),]
View(dat)
dat <- dat[!(is.na(dat$blot) | is.na(dat$body)),]
dat <- read.table("alllabs.txt", header = TRUE, stringsAsFactors = FALSE, na.strings = ".")
View(dat)
apply(is.na(dat),2,mean)
dim(is.na(dat))
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2); library(dplyr); library(reshape2); library(knitr)
dat <- read.table("alllabs.txt", header = TRUE, stringsAsFactors = FALSE, na.strings = ".")
dat <- dat[!(is.na(dat$blot) | is.na(dat$body)),]
weights <- dat[,c("body", "blot")]
ggplot(data = weights,
mapping = aes(x=body, y=blot)) +
geom_point() +
labs(title="Blotted Weight vs. Body Weight",
x="Body Weight",
y="Blotted Weight"
) +
theme(plot.title = element_text(hjust = 0.5))
grpweights <- dat[,c("body", "blot","lab", "proto", "group")]
ggplot(data = grpweights,
mapping = aes(x=body, y=blot, color=proto)) +
geom_point() +
labs(title="Blotted Weight vs. Body Weight",
x="Body Weight",
y="Blotted Weight",
color="Protocol"
) +
theme(plot.title = element_text(hjust = 0.5))
labweights <- dat[,c("body", "blot", "lab")]
labweights_long <- melt(labweights, id="lab")
ggplot(data = labweights_long,
mapping = aes(x=lab, y=value, color = variable)) +
geom_boxplot() +
labs(title = "Weight by Lab",
x = "Lab",
y = "Weight",
color = "Weighed Object") +
theme(axis.text.x = element_text(angle = 90, hjust=1),
plot.title = element_text(hjust = 0.5))
ggplot(data = labweights_long,
mapping = aes(x=lab, y=log(value), color = variable)) +
geom_boxplot() +
labs(title = "log(Weight) by Lab",
x = "Lab",
y = "log(Weight)",
color = "Weighed Object") +
theme(axis.text.x = element_text(angle = 90, hjust=1),
plot.title = element_text(hjust = 0.5))
protoweights <- dat[,c("body", "blot", "proto")]
protoweights_long <- melt(protoweights, id="proto")
ggplot(data = protoweights_long,
mapping = aes(x=proto, y=log(value), color = variable)) +
geom_boxplot() +
labs(title = "log(Weight) by Protocol",
x = "Protocol",
y = "log(Weight)",
color = "Weighed Object") +
theme(plot.title = element_text(hjust = 0.5))
dosage_groups
dosage_groups <-  dat %>%
group_by(group) %>%
summarize(dose1 = unique(dose1),
dose2 = unique(dose2),
A = sum(proto == "A"),
B = sum(proto == "B"),
C = sum(proto == "C"),
D = sum(proto == "D")
) %>% as.data.frame()
doselabels <- apply(dosage_groups[,c("dose1", "dose2")], 1, paste, collapse = ", ") %>% paste("(", ., ")", sep="")
ggplot(data = dat ,
mapping=aes(x=as.factor(group), y=log(blot))) +
geom_boxplot() +
labs(title = "log(Blotted Weight) by Dosage",
x = "Combination of (Dose 1, Dose 2)",
y = "log(Blotted Weight)") +
scale_x_discrete(labels = doselabels) +
theme(axis.text.x = element_text(angle = 45, hjust=1),
plot.title = element_text(hjust = 0.5))
kable(dosage_groups)
head(dat)
dat %>% group_by(proto)
head(dat)
plot(log(dat$blot) ~ dose1)
plot(log(dat$blot) ~ dat$dose1)
plot(log(dat$blot) ~ dat$dose1^2)
plot(log(dat$blot) ~ dat$dose1^2)
plot(log(dat$blot) ~ I(dat$dose1)^2)
plot(log(dat$blot) ~ I(dat$dose1^2))
plot(log(dat$blot) ~ I(dat$dose1^0.5))
plot(log(dat$blot) ~ I(dat$dose1^0.5))
lm(log(dat$blot) ~ I(dat$dose1^0.5))
lm(log(dat$blot) ~ I(dat$dose1^0.5)) %>% plot()
lm(log(dat$blot) ~ I(dat$dose1^0.5)*dose2) %>% plot()
lm(log(dat$blot) ~ I(dat$dose1^0.5)*dat$dose2) %>% plot()
lm(log(dat$blot) ~ I(dat$dose1^0.5)) %>% plot()
